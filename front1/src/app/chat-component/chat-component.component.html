<div class="chat-container">
  <h2>Chat Service Client</h2>
  
  <div class="connection-status" 
       [class.connected]="isConnected && !isSimulated" 
       [class.disconnected]="!isConnected"
       [class.simulated]="isSimulated">
    
    <span class="status-text">Status: {{ connectionStatus }}</span>
    
    <span *ngIf="isSimulated" class="simulated-badge">Simulated</span>
    
    <button *ngIf="!isConnected && !isSimulated" (click)="reconnect()" class="reconnect-btn">
      ↻ Reconnect
    </button>
  </div>

  <div *ngIf="isSimulated" class="simulated-warning">
    <p>⚠️ Running in simulated mode - messages are not being sent to the server</p>
  </div>

  <div class="chat-messages">
    <!-- Afficher les messages du PLUS RÉCENT au PLUS ANCIEN -->
    <div *ngFor="let msg of messages" class="chat-message">
      <strong>{{ msg.sender }}:</strong> {{ msg.content }}
      <small *ngIf="msg.timestamp" class="timestamp">
        {{ msg.timestamp | date:'HH:mm:ss' }}
      </small>
    </div>
    
    <div *ngIf="messages.length === 0" class="empty-state">
      No messages yet. Start a conversation!
    </div>
  </div>

  <div class="chat-input">
    <input 
      [(ngModel)]="message" 
      placeholder="Votre message" 
      (keyup.enter)="send()"
      [disabled]="!isConnected"
    />
    <button (click)="send()" [disabled]="!isConnected || !message.trim()">
      {{ isSimulated ? 'Simulate' : 'Send' }}
    </button>
  </div>
</div>